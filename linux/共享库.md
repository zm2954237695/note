#### 共享库

```bash
gcc -fPIC -c a.c
gcc -fPIC -c b.c
gcc -shared -W1 -o libmyab.so a.o b.o
```

对于不加 -fPIC生成的动态库，“ 生成动态库时假定它被加载在地址 0 处。加载时它会被加载到一个地址（base），这时要进行一次重定位（relocation），把代码、数据段中所有的地址加上这个 base 的值。这样代码运行时就能使用正确的地址了。”

#### 加fPIC选项

加上fPIC选项生成的动态库，显然是位置无关的

“这样的代码本身就能被放到线性地址空间的任意位置，无需修改就能正确执行。通常的方法是获取指令指针的值，加上一个偏移得到全局变量/函数的地址。”

加fPIC选项的 源文件对于，它引用的函数头文件编写有很宽松的尺度。