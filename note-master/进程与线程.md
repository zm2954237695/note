##### 进程与线程

进程：一个在内存中的应用程序。每个进程都有自己独立的一块内存空间，一个进程可以有多个线程。

线程：进程中的一个执行单元，负责当前进程程序的执行。一个进程至少有一个线程，一个进程可以运行多个线程，多个线程共享数据。

与进程不同的是同类的多个线程共享进程堆和方法区资源，但每个线程都有自己的程序计数器、本地方法栈、虚拟机栈。线程的执行开销比进程小。

##### 区别

根本区别：进程是操作系统资源分配的基本单位，线程是处理器任务调度和执行的基本单位。

资源开销：每个进程都有独立的代码和数据空间(程序上下文),进程之间的切换会有很大的开销。线程可以看成轻量级的进程，同一类线程共享代码和数据空间，每个线程都有自己独立的运行栈和程序计数器，线程之间切换的开销小。

包含关系：如果一个进程内有多个线程，则执行过程不是一条线的，而是多线程共同完成的；线程是进程的一部分，所以线程也被称为轻权进程或者轻量级进程。

内存分配：同一进程的线程共享本进程的地址空间和资源，而进程之间的地址空间和资源是相互独立的

影响关系：一个进程崩溃后，在保护模式下不会对其他进程产生影响，但是一个线程崩溃整个进程都死掉。所以多进程比多线程健壮。

执行过程：每个独立的进程有程序运行的入口、顺利执行序列和程序出口。但是线程不能独立执行，必须依存在应用程序中，由应用程序提供多个线程执行控制，两者均可并发执行。 

##### ThreadLocal

**作用**

ThreadLocal主要功能是给每个线程创建变量副本，这样就可以保证一个线程对某个变量的修改不会影响到其他线程对该变量的使用。

**原理**

ThreadLocal是基于每个线程对象内部一个threadLocals的属性来实现的。它的类型是ThreadLocalMap，它以ThreadLocal本身为键值，副本对象作为value，这样当每个线程调用该对象时就可以直接自身的threadLocals属性中获得变量副本进行操作。

