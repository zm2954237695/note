### 3.登录-控制层

#### 3.1处理异常

业务层抛出的异常是什么，需要在统一异常处理类中进行统一的捕获和处理，如果业务层抛出的异常类型已经在统一异常处理类中处理过，则不需要重复处理。

```java
else if(e instanceof UserNotFoundException){
    result.setState(5001);
    result.setMessage("用户数据不存在的异常");
} else if(e instanceof PasswordNotMatchException){
    result.setState(5002);
    result.setMessage("用户名的密码错误的异常");
```

#### 3.2设计请求

请求路径：/users/login

请求方式: POST

请求数据: String username, String password

响应结果: JsonResult<User>

### 3.3处理请求

在UserController类中编写处理请求的方法.

### 4.登录-前端页面

1.在login.html页面中根据前面所设置的请求来发送ajax请求。

2.访问页面进行用户的登录操作。

##### 用户会话session

session对象主要存在服务器端,可以用于保存服务器的临时数据的对象，所保存的数据可以在整个项目中都可以通过访问来获取，把session的数据看做一个共享的数据。首次登录的时候所获取的用户的数据，转移到session对象即可。

##### 拦截器

首先讲所有的请求统一拦截到拦截器中，可以使用拦截器来定义过滤的规则，如果不满足系统的设置的过滤规则，统一的处理是重新是打开login.html(重定向或者转发),推荐重定向。

```java
public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
   //通过HttpServletRequest对象来获取session对象.
    Object uid = request.getSession().getAttribute("uid");
    if (uid == null){
         response.sendRedirect("/web/login.html");
         return false;
    }
    return true;
}
```

2.注册过滤器：添加白名单(login.html\register.html\login.html\

reg.html\index.htm;\produce.html)，黑名单.

3.注册过滤器的技术: 借助WebMvcConfigure接口.定义一个类来实现这样的接口就可以注册过滤器.
